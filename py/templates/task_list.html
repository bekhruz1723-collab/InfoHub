{% for task in tasks %}
<div class="task-item" id="task-{{ task.id }}">
	<div class="task-header">
		<div
			style="
				font-weight: bold;
				font-size: 1.1em;
				display: flex;
				align-items: center;
				gap: 10px;
				flex-wrap: wrap;
			"
		>
			{{ task.title }}
			<button
				onclick="toggleTaskPublic({{ task.id }})"
				title="{{ _('dashboard_public_label') if not task.is_public else _('dashboard_private') }}"
				style="
					font-size: 0.7em;
					background: {{ 'var(--accent-color)' if task.is_public else 'transparent' }};
					color: {{ 'black' if task.is_public else 'var(--text-color)' }};
					border: 1px solid var(--accent-color);
					padding: 2px 8px;
					border-radius: 12px;
					cursor: pointer;
					transition: all 0.2s;
				"
			>
				{{ _('dashboard_public') if task.is_public else _('dashboard_private') }}
			</button>
		</div>
		{% if task.deadline %}
		<div
			style="font-size: 0.9em; color: {{ '#ef4444' if task.deadline < now and not task.completed else 'rgba(255,255,255,0.6)' }}"
		>
			ğŸ“… {{ task.deadline.strftime('%d.%m.%Y') }}
		</div>
		{% endif %}
	</div>

	<div class="task-progress-bar">
		<div class="task-progress-fill" style="width: {{ task.progress }}%;"></div>
	</div>

	<div class="sub-tasks">
		{% if task.steps %} {% for step in task.steps %}
		<div class="step-item">
			<div
				class="custom-checkbox {{ 'checked' if step.completed else '' }}"
				onclick="toggleStep({{ step.id }})"
			></div>
			<span
				style="text-decoration: {{ 'line-through' if step.completed else 'none' }}; opacity: {{ '0.6' if step.completed else '1' }};"
				>{{ step.content }}</span
			>
		</div>
		{% endfor %} {% else %}
		<div class="step-item" style="margin-top: 10px">
			<div
				class="custom-checkbox {{ 'checked' if task.completed else '' }}"
				onclick="toggleTask({{ task.id }})"
			></div>
			<span
				style="text-decoration: {{ 'line-through' if task.completed else 'none' }}; opacity: {{ '0.6' if task.completed else '1' }};"
				>{{ _('dashboard_mark_completed') }}</span
			>
		</div>
		{% endif %}
	</div>
</div>
{% else %}
<div style="text-align: center; padding: 20px; opacity: 0.5">
	{{ _('dashboard_no_tasks') }}
</div>
{% endfor %}