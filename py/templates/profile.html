{% extends "base.html" %} {% block content %}
<div class="glass-card" style="max-width: 600px; margin: 0 auto">
	<form method="POST" enctype="multipart/form-data">
		<div style="text-align: center; margin-bottom: 20px">
			<div class="file-upload-wrapper">
				<img
					src="{% if user.avatar and user.avatar.startswith('http') %}{{ user.avatar }}{% else %}{{ url_for('static', filename='uploads/' + (user.avatar or 'default.svg')) }}{% endif %}"
					id="avatarPreview"
					style="
						width: 120px;
						height: 120px;
						border-radius: 50%;
						object-fit: cover;
						border: 3px solid var(--accent-color);
						margin-bottom: 10px;
					"
				/>
				<br />
				<label for="avatarInput" class="file-upload-label">üì∏ –ò–∑–º–µ–Ω–∏—Ç—å</label>
				<input
					type="file"
					name="avatar"
					id="avatarInput"
					style="display: none"
					accept="image/*"
					onchange="document.getElementById('avatarPreview').src = window.URL.createObjectURL(this.files[0])"
				/>
			</div>

			<h2>{{ user.username }}</h2>
			<p style="opacity: 0.7">@{{ user.nickname }}</p>
		</div>

		<label>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
		<input type="text" name="username" value="{{ user.username }}" />

		<label>–û —Å–µ–±–µ</label>
		<textarea name="bio" rows="3">{{ user.bio or '' }}</textarea>

		<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px">
			<div>
				<label>–í–æ–∑—Ä–∞—Å—Ç</label>
				<input
					type="number"
					name="age"
					value="{{ user.age or '' }}"
					placeholder="–ù–µ —É–∫–∞–∑–∞–Ω–æ"
				/>
			</div>
			<div>
				<label>–ü–æ–ª</label>
				<select name="gender">
					<option value="" {% if not user.gender %}selected{% endif %}>
						–ù–µ —É–∫–∞–∑–∞–Ω–æ
					</option>
					<option value="Male" {% if user.gender == 'Male' %}selected{% endif %}>
						–ú—É–∂—Å–∫–æ–π
					</option>
					<option value="Female" {% if user.gender == 'Female' %}selected{% endif %}>
						–ñ–µ–Ω—Å–∫–∏–π
					</option>
				</select>
			</div>
		</div>

		<label>–¶–µ–ª–∏</label>
		<textarea name="goals" placeholder="–ú–æ–∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ —Ü–µ–ª–∏...">
{{ user.goals or '' }}</textarea
		>

		<button type="submit" class="btn-primary" style="width: 100%; margin-top: 10px">
			–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
		</button>
	</form>

	<div
		style="
			margin-top: 40px;
			padding-top: 20px;
			border-top: 1px solid rgba(255, 255, 255, 0.1);
			display: flex;
			flex-direction: column;
			gap: 15px;
		"
	>
		<a
			href="{{ url_for('logout') }}"
			class="btn-outline"
			style="
				text-align: center;
				text-decoration: none;
				display: block;
			"
			>–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞</a
		>

		<button
			onclick="openDeleteModal()"
			class="btn-danger"
			style="width: 100%"
		>
			–£–¥–∞–ª–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
		</button>
	</div>
</div>

<div id="deleteModal" class="modal-overlay">
	<div class="modal-content animate-modal">
		<h2 style="color: var(--danger-color)">–£–¥–∞–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞</h2>
		<p>
			–í—ã —É–≤–µ—Ä–µ–Ω—ã? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ <b>–Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ</b> —É–¥–∞–ª–∏—Ç –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å –∏ –≤—Å–µ –∑–∞–¥–∞—á–∏.
		</p>
		<div class="modal-actions">
			<button
				class="btn-primary"
				style="background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white"
				onclick="closeDeleteModal()"
			>
				–û—Ç–º–µ–Ω–∞
			</button>
			<form action="{{ url_for('delete_account') }}" method="POST">
				<button type="submit" class="btn-danger">–î–∞, —É–¥–∞–ª–∏—Ç—å</button>
			</form>
		</div>
	</div>
</div>

<script>
	function openDeleteModal() {
		const modal = document.getElementById("deleteModal");
		modal.style.display = "flex";
	}
	function closeDeleteModal() {
		document.getElementById("deleteModal").style.display = "none";
	}
</script>
{% endblock %}